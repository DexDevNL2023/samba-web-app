<div class="d-flex justify-content-center">
  <div class="p-col-12 p-md-8">
    <h2 class="mt-3">Mot de passe pour <strong>{{ account?.login }}</strong></h2>

    <p-message *ngIf="success" severity="success" text="Mot de passe modifié avec succès !"></p-message>
    <p-message *ngIf="error" severity="error" text="Une erreur s'est produite ! Le mot de passe n'a pas pu être modifié."></p-message>
    <p-message *ngIf="doNotMatch" severity="error" text="Le mot de passe et sa confirmation ne correspondent pas !"></p-message>

    <form name="form" (ngSubmit)="changePassword()" [formGroup]="passwordForm" class="p-fluid">
      <div class="mb-3">
        <label for="currentPassword" class="block text-900 font-medium mb-2 mt-0">Mot de passe actuel</label>
        <p-password id="currentPassword" type="password" placeholder="Mot de passe actuel"
        name="currentPassword" formControlName="currentPassword" data-cy="currentPassword" class="w-full"
        [style]="{'width':'100%', 'height':'45px'}" inputStyleClass="w-full" [feedback]="true" [toggleMask]="true"/>

        <small *ngIf="passwordForm.get('currentPassword')!.invalid && (passwordForm.get('currentPassword')!.dirty || passwordForm.get('currentPassword')!.touched)" class="form-text text-danger">
          Votre mot de passe est requis.
        </small>
      </div>

      <div class="mb-3">
        <label for="newPassword" class="block text-900 font-medium mb-2 mt-0">Nouveau mot de passe</label>
        <p-password id="newPassword" type="password" placeholder="Nouveau mot de passe"
        name="newPassword" formControlName="newPassword" data-cy="newPassword" class="w-full"
        [style]="{'width':'100%', 'height':'45px'}" inputStyleClass="w-full" [feedback]="true" [toggleMask]="true"/>

        <small *ngIf="passwordForm.get('newPassword')!.invalid && (passwordForm.get('newPassword')!.dirty || passwordForm.get('newPassword')!.touched)" class="form-text text-danger">
          <ng-container *ngIf="passwordForm.get('newPassword')?.errors?.required">
            Votre nouveau mot de passe est requis.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('newPassword')?.errors?.minlength">
            Votre nouveau mot de passe doit comporter au moins 4 caractères.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('newPassword')?.errors?.maxlength">
            Votre nouveau mot de passe ne peut pas dépasser 50 caractères.
          </ng-container>
        </small>
      </div>

      <div class="mb-3">
        <label for="confirmPassword" class="block text-900 font-medium mb-2 mt-3">Confirmation du nouveau mot de passe</label>
        <p-password id="confirmPassword" type="password" placeholder="Confirmation du nouveau mot de passe"
        name="confirmPassword" formControlName="confirmPassword" data-cy="confirmPassword" class="w-full"
        [style]="{'width':'100%', 'height':'45px'}" inputStyleClass="w-full" [feedback]="true" [toggleMask]="true"/>

        <small *ngIf="passwordForm.get('confirmPassword')!.invalid && (passwordForm.get('confirmPassword')!.dirty || passwordForm.get('confirmPassword')!.touched)" class="form-text text-danger">
          <ng-container *ngIf="passwordForm.get('confirmPassword')?.errors?.required">
            Votre confirmation de mot de passe est requise.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('confirmPassword')?.errors?.minlength">
            Votre confirmation de mot de passe doit comporter au moins 4 caractères.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('confirmPassword')?.errors?.maxlength">
            Votre confirmation de mot de passe ne peut pas dépasser 50 caractères.
          </ng-container>
        </small>
      </div>

      <button label="Se connecter" type="submit" data-cy="submit" class="p-element p-ripple w-full mt-6 p-3 font-medium p-button p-component" [disabled]="passwordForm.invalid">
          <span class="p-button-label">Enregistrer</span>
          <span class="p-ink"></span>
      </button>
    </form>
  </div>
</div>
